struct Nodo2{
    int info;
    Nodo * ant;
    Nodo * prox;
}

class ListaDupla{
    
    private:
        Nodo2 * inicio;
        Nodo2 * fim;

    public:
    
    //construtor lista
    ListaDupla (){
        inicio = nullptr;
        fim = nullptr;
    }
    
    void inserir(int valor){
        Nodo * novo;
        novo = new Nodo();      

        if (novo == nullptr){
            cout<<"Erro ao alocar"<<endl; //verifica se da para alocar
            return;
        }
        //insere valor no nodo
        novo->info = valor;
        
        //se for no incio da lista
        if(inicio == nullptr){ 
            inicio = novo;
            fim = novo;
            return;
        } 
        
        //outros casos
        fim->prox = novo;
        novo->ant = fim;
        fim = novo;
        
        
       
    }
    
    void retirar(int valor) {
        if(inicio == nullptr){
            cout<<"Lista vazia"<<endl;
            return;
        }
        
        Nodo2 * auxiliar = inicio;
        
        while(auxiliar!= nullptr){
            //busca o valor para remover o Nodo2
            if(auxiliar->info == valor){
                Nodo2 * retira = aux;
                //primeiro elemento
                if(aux->ant == nullptr){
                    inicio = aux->prox;
                    if(inicio != nullptr){ 
                        inicio->ant == nullptr;
                        
                    }
                }else{
                    //ultimo elemento
                    if(aux->prox == nullptr){
                        fim = aux->ant;
                        fim->prox = nullptr;
                    } 
                    //outros casos
                    else{
                        aux->ant->prox = aux->prox;
                        aux->prox->ant = aux->ant;
                    }
                }
                delete retira;
                return;
            }
            aux = aux->prox;
        }
        
        //caso valor não encontrado
        if(aux == nullptr){
            cout<<"Valor não encontrado na lista"<<endl;
            return nullptr;
        }
        
    }
    
    void EliminaProximos(int valor){
        if(inicio == nullptr){
            cout<<"Lista Dupla Vazia"<<endl;
            return;
        }
        
        Nodo2 * aux = inicio;
        
        //se só tiver um elemento
        if(inicio->prox == nullptr){
            cout<<"Não é possivel fazer a alteração"<<endl;
            return;
        }
        
        // se só tiver dois elementos
        if(inicio->prox->prox == nullptr){
            cout<<"Não é possivel fazer a alteração"<<endl;
            return;
        }
        
        while(aux != nullptr){
            //busca pelo numero
            if(aux->info == valor){
                // caso não for no inicio da lista
                if(aux->ant != nullptr){
                    Nodo2 * anterior = aux->ant;
                    if(anterior->ant != nullptr){
                        anterior->ant->prox = aux;
                        aux->ant = anterior->ant;
                    } else {
                        //caso inicio
                        inicio = aux;
                        aux->ant = nullptr;
                    }
                    delete anterior;
                }
                //caso for no fim da lista 
                if(aux->prox != nullptr){
                    Nodo2 * sucessor = aux->prox;
                    if(sucessor->prox != nullptr){
                        sucessor->prox->ant = aux ;
                        aux->prox = sucessor->prox;
                    } else{
                        //caso fim
                        aux->prox = nullptr;
                        fim = aux;
                    }
                    delete sucessor;
                }
                return;
            }
            aux = aux->prox;
        }
        
        //caso o valor não esteja na lista
        if(aux == nullptr){
            cout<<"Valor não encontrado na lista"<<endl;
            return nullptr;
        }
    }
    
    void exibir(){
         if(inicio == nullptr){
            cout<<"Lista Dupla Vazia"<<endl;
            return nullptr;
        }
        
        Nodo * auxiliar;
        //aponta para o primeiro elemento
        auxiliar = inicio;

        //enquanto auxiliar for diferente de nulo, ele irá imprimir elementos
        while (auxiliar != nullptr){
            cout<< auxiliar->info <<endl; //imprimir o elemento apontado em info
            auxiliar = auxiliar -> prox;  // passa a apontar para a prox regiao
        }
        
    }
    
    void menu(){
        //função para imprimir o menu
        cout<<"\n///////MENU////////"<<endl;
        cout<<"Insira 1 para inserir"<<endl;
        cout<<"Insira 2 para retirar um Nodo"<<endl;
        cout<<"Insira 3 para retirar Nodos proximos"<<endl;
        cout<<"Insira 4 para exibir lista"<<endl;
        cout<<"Insira 5 para sair"<<endl;
        cout<<"Digite uma opcao: ";
    }
};

int main(){
    ListaDupla lista;
    int opcao = 0;
    
    do{
        lista.menu();  
        cin<<opcao;
        switch(opcao){
            case 1: {
                int valor = 0;
                cout<<"Insira valor para inserir"<<endl;
                cin>>valor;
                lista.inserir(valor);
                break;
            }
            case 2: {
                int valor = 0;
                cout<<"Insira valor para retirar (o Nodo)"<<endl;
                cin>>valor;
                lista.retirar(valor);
                break;
            }
            case 3: {
                int valor = 0;
                cout<<"Insira valor para retirar (os Nodos próximos)"<<endl;
                cin>>valor;
                lista.EliminaProximos(valor);
                break;
            }
            case 4:
                cout<<"Exibindo a lista..."<<endl;
                lista.Exibindo();
                break;
            case 5:
                cout<<"Operação Finalizada"<<endl;
                break;
            default:
                cout<<"Operação inválida"<<endl;
                break;
        }
        
    } while(opcao != 5)
    

    
    return 0;
}
